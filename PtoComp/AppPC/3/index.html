<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bitnarys ¬∑ Pilar 3: Reconocimiento de Patrones</title>
<style>
  :root{
    --ok:#22c55e; --warn:#facc15; --err:#ef4444;
    --bg:#070b16; --glass:rgba(15,27,60,.45); --line:#2a3c74;
  }
  body{margin:0;font-family:Poppins,Arial,sans-serif;color:#eaf2ff;background:var(--bg)}
  #starfield{position:fixed;inset:0;z-index:-1}
  h1{color:#4ade80;padding:16px;margin:0;text-align:center}
  .sub{color:#a9b9e6;padding:0 16px 16px;text-align:center}

  .biobot{
    margin:16px;padding:14px;border-radius:14px;
    background:rgba(14,26,62,.7);border:1px solid var(--line);
    box-shadow:0 0 14px rgba(74,222,128,.35);
  }
  .biobot h2{margin:0 0 6px;text-shadow:0 0 6px #4ade80}

  /* Bandeja */
  .tray{
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:16px;
    padding:16px;
  }
  @media (max-width:1000px){.tray{grid-template-columns: repeat(2,1fr);}}
  @media (max-width:600px){.tray{grid-template-columns: 1fr;}}

  .chip{
    background:rgba(20,32,70,.6);
    border:1px solid #2c3f79;
    box-shadow:0 4px 12px rgba(0,0,0,.4);
    border-radius:12px;
    padding:12px;
    text-align:center;
    cursor:grab;
    transition:all .2s ease;
    font-size:.95rem;
  }
  .chip:hover{transform:scale(1.05)}
  .chip:active{cursor:grabbing;transform:scale(.97)}

  /* Zonas */
  .zones{
    display:grid;
    grid-template-columns: repeat(4, 1fr);
    gap:18px;
    padding:20px;
  }
  .zone{
    min-height:140px;
    border:1.5px dashed #2e3f76;
    background:rgba(15,27,60,.4);
    border-radius:14px;
    padding:16px;
    transition:.3s;
  }
  .zone.active{border-color:#4ade80;box-shadow:0 0 8px #4ade80}
  .zone h3{text-align:center;margin-bottom:12px;font-size:1rem}
  .bucket{min-height:80px;display:flex;flex-wrap:wrap;gap:8px;justify-content:center}

  /* Botones */
  .actions{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;padding:12px}
  button{
    margin:12px;padding:10px 14px;background:#238636;color:#fff;
    border:none;border-radius:10px;cursor:pointer
  }
  button:hover{background:#2ea043}

  #resultado{margin:16px;padding:14px;border-radius:12px;background:var(--glass)}
  .system{padding:10px;border-radius:10px;margin-top:8px;font-weight:bold;text-align:center}
  .offSys{background:#311b1b;color:#f87171}
  .onSys{background:#052e16;color:#4ade80}
</style>
</head>
<body>
<canvas id="starfield"></canvas>

<h1>Bitnarys ¬∑ Pilar 3: Reconocimiento de Patrones</h1>
<div class="sub">Encuentra similitudes y repite soluciones.</div>

<!-- Biobot -->
<div id="biobot" class="biobot">
  <h2>ü§ñ Biobot</h2>
  <p>Bienvenido al <b>Pilar 3: Reconocimiento de Patrones</b>.  
  Este pilar significa identificar <b>similitudes y repeticiones</b> en problemas para aplicar soluciones conocidas.  
  <b>Misi√≥n:</b> clasifica los componentes en su categor√≠a y luego rep√°ralos en el sistema correcto.</p>
</div>

<!-- Fase 1 -->
<div id="phase1">
  <h2 style="text-align:center">Fase 1 ¬∑ Identificaci√≥n</h2>
  <div id="toolbox" class="tray"></div>
  <div class="zones">
    <div class="zone" data-accept="energia"><h3>‚ö° Energ√≠a</h3><div class="bucket" id="bucket-energia"></div></div>
    <div class="zone" data-accept="comunicacion"><h3>üì° Comunicaci√≥n</h3><div class="bucket" id="bucket-comunicacion"></div></div>
    <div class="zone" data-accept="navegacion"><h3>üß≠ Navegaci√≥n</h3><div class="bucket" id="bucket-navegacion"></div></div>
    <div class="zone" data-accept="ruido"><h3>üóëÔ∏è No pertenece</h3><div class="bucket" id="bucket-ruido"></div></div>
  </div>
  <div class="actions"><button id="toPhase2">Ir a Fase 2</button></div>
</div>

<!-- Fase 2 -->
<div id="phase2" style="display:none">
  <h2 style="text-align:center">Fase 2 ¬∑ Reparaci√≥n</h2>
  <div class="zones">
    <div class="zone" data-accept="energia"><h3>‚ö° Energ√≠a</h3><div class="bucket" id="zone-energia"></div></div>
    <div class="zone" data-accept="comunicacion"><h3>üì° Comunicaci√≥n</h3><div class="bucket" id="zone-comunicacion"></div></div>
    <div class="zone" data-accept="navegacion"><h3>üß≠ Navegaci√≥n</h3><div class="bucket" id="zone-navegacion"></div></div>
  </div>
  <div id="systems">
    <div id="sys-energia" class="system offSys">‚ö° Energ√≠a: Desactivado</div>
    <div id="sys-comunicacion" class="system offSys">üì° Comunicaci√≥n: Desactivado</div>
    <div id="sys-navegacion" class="system offSys">üß≠ Navegaci√≥n: Desactivado</div>
  </div>
  <div class="actions"><button id="evaluate">Evaluar misi√≥n</button></div>
</div>

<div id="resultado"></div>

<script>
/* Fondo estelar */
(function(){
  const c=document.getElementById('starfield'),ctx=c.getContext('2d');
  function resize(){c.width=innerWidth;c.height=innerHeight}resize();
  addEventListener('resize',resize);
  const stars=[...Array(120)].map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,z:Math.random()*1.2+.2,r:Math.random()*1.4+.2}));
  function step(){
    ctx.clearRect(0,0,c.width,c.height);
    for(const s of stars){
      s.x+=s.z*0.25;s.y+=s.z*0.12;
      if(s.x>c.width) s.x=0;if(s.y>c.height) s.y=0;
      ctx.globalAlpha=.35+s.z*.45;ctx.fillStyle='#bcd7ff';
      ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();
    }requestAnimationFrame(step);
  }step();
})();

/* Tarjetas */
const CARDS=[
  {t:"üîã Bater√≠a solar",type:"energia"},
  {t:"‚ö° Panel el√©ctrico",type:"energia"},
  {t:"üì° Antena larga",type:"comunicacion"},
  {t:"üéôÔ∏è Micr√≥fono de cabina",type:"comunicacion"},
  {t:"üß≠ Giroscopio",type:"navegacion"},
  {t:"üõ∞Ô∏è GPS",type:"navegacion"},
  {t:"üé§ Karaoke",type:"ruido"},
  {t:"üì∏ Selfie espacial",type:"ruido"}
];
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]]}return a;}
const toolbox=document.getElementById('toolbox');
shuffle(CARDS).forEach(c=>{
  const el=document.createElement('div');
  el.className='chip'; el.draggable=true; el.textContent=c.t;
  el.dataset.type=c.type; toolbox.appendChild(el);
});

/* Drag & Drop */
let dragItem=null;
function initDrag(root){
  root.querySelectorAll('.chip').forEach(ch=>{
    ch.addEventListener('dragstart',()=>{dragItem=ch});
    ch.addEventListener('dragend',()=>{dragItem=null});
  });
}
initDrag(toolbox);
document.querySelectorAll('.zone').forEach(z=>{
  z.addEventListener('dragover',e=>e.preventDefault());
  z.addEventListener('drop',e=>{
    e.preventDefault();
    if(dragItem && (!z.dataset.accept || dragItem.dataset.type===z.dataset.accept)){
      z.querySelector('.bucket')?.appendChild(dragItem);
      initDrag(z);
    }
  });
});

/* Biobot */
function biobotSpeak(msg){
  const bio=document.getElementById("biobot");
  bio.innerHTML=`<h2>ü§ñ Biobot</h2><p>${msg}</p>`;
  if('speechSynthesis' in window){
    window.speechSynthesis.cancel();
    const utter=new SpeechSynthesisUtterance(msg);
    utter.lang="es-ES"; utter.rate=1;
    const voces=window.speechSynthesis.getVoices();
    const vozEsp=voces.find(v=>v.lang.startsWith("es"));
    if(vozEsp) utter.voice=vozEsp;
    setTimeout(()=>window.speechSynthesis.speak(utter),300);
  }
}
biobotSpeak("Soy Biobot. En este Pilar 3 aprender√°s el Reconocimiento de Patrones. Identifica las similitudes en los componentes para reparar la nave.");

/* Paso a Fase 2 */
document.getElementById('toPhase2').onclick=()=>{
  const energia=[...document.querySelectorAll('#bucket-energia .chip')].length;
  const comunicacion=[...document.querySelectorAll('#bucket-comunicacion .chip')].length;
  const navegacion=[...document.querySelectorAll('#bucket-navegacion .chip')].length;
  if(energia<2 || comunicacion<2 || navegacion<2){
    biobotSpeak("A√∫n no has identificado todos los patrones. Revisa la clasificaci√≥n.");
    return;
  }
  document.querySelectorAll('#bucket-energia .chip, #bucket-comunicacion .chip, #bucket-navegacion .chip').forEach(ch=>{
    ch.draggable=true;
    document.getElementById('zone-'+ch.dataset.type).appendChild(ch);
  });
  document.getElementById('phase2').style.display="block";
  biobotSpeak("Bien. Ahora coloca cada componente en su sistema. Cuando completes un patr√≥n, se encender√°.");
};

/* Evaluaci√≥n */
document.getElementById('evaluate').onclick=()=>{
  const energia=[...document.querySelectorAll('#zone-energia .chip')].length;
  const comunicacion=[...document.querySelectorAll('#zone-comunicacion .chip')].length;
  const navegacion=[...document.querySelectorAll('#zone-navegacion .chip')].length;

  if(energia===2){document.getElementById("sys-energia").className="system onSys";document.getElementById("sys-energia").textContent="‚ö° Energ√≠a: Activado";}
  if(comunicacion===2){document.getElementById("sys-comunicacion").className="system onSys";document.getElementById("sys-comunicacion").textContent="üì° Comunicaci√≥n: Activado";}
  if(navegacion===2){document.getElementById("sys-navegacion").className="system onSys";document.getElementById("sys-navegacion").textContent="üß≠ Navegaci√≥n: Activado";}

  let completos=(energia===2)+(comunicacion===2)+(navegacion===2);
  let incompletos=3-completos;
  let errores=0; // en este dise√±o no hay error directo, solo incompleto

  document.getElementById("resultado").innerHTML=
    `<p>Completados: ${completos} ‚úÖ ¬∑ Incompletos: ${incompletos} ‚è≥ ¬∑ Errores: ${errores} ‚ö†Ô∏è</p>`;

  if(completos===3){
    biobotSpeak("¬°Misi√≥n completada! Has reconocido los patrones y reparado la nave. En la vida real, el Reconocimiento de Patrones te ayuda a detectar similitudes en matem√°ticas, programaci√≥n o incluso m√∫sica, aplicando soluciones conocidas a nuevos problemas.");
  }else{
    biobotSpeak("A√∫n faltan sistemas por completar. Revisa los patrones restantes.");
  }
};
</script>
</body>
</html>
