<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Pilar 2 · Abstracción</title>
<style>
  :root{
    --ink:#eaf2ff; --muted:#a9b9e6; --bg:#070b16;
    --glass:rgba(15,27,60,.45); --line:#2a3c74;
    --ok:#22c55e; --warn:#facc15; --err:#ef4444;
  }
  body{margin:0;font-family:Poppins,Arial,sans-serif;background:var(--bg);color:var(--ink)}
  #starfield{position:fixed;inset:0;z-index:-1}

  /* Encabezado unificado */
  header{padding:16px 12px;text-align:center;border-bottom:1px solid var(--line);background:rgba(10,18,38,.55)}
  header h1{margin:0;color:#4ade80;font-size:22px;letter-spacing:.3px}
  header .sub{margin-top:6px;color:var(--muted);font-size:14px}

  /* Paneles */
  .panel{background:var(--glass);border:1px solid var(--line);border-radius:12px;padding:12px;margin:12px}

  /* Bandeja 4xN */
  .tray{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;padding:8px}
  @media (max-width:1000px){.tray{grid-template-columns:repeat(2,1fr)}}
  @media (max-width:600px){.tray{grid-template-columns:1fr}}

  .chip{
    user-select:none;cursor:grab;border-radius:12px;padding:10px 12px;text-align:center;
    background:rgba(20,32,70,.60);border:1px solid #2c3f79;box-shadow:0 4px 12px rgba(0,0,0,.4);
    transition:transform .15s ease;font-size:.95rem
  }
  .chip:hover{transform:scale(1.05)}
  .chip:active{cursor:grabbing;transform:scale(.97)}

  /* Zonas */
  .zones{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;padding:12px}
  .zone{border:1.5px dashed #2e3f76;border-radius:12px;padding:10px;min-height:180px;
        background:rgba(15,27,60,.4);transition:.2s}
  .zone h3{text-align:center;margin:0 0 8px;color:var(--muted)}

  .bucket{min-height:120px;display:flex;flex-wrap:wrap;gap:8px;justify-content:center}

  /* Botones */
  .actions{display:flex;gap:10px;justify-content:center;padding:12px}
  button{padding:10px 14px;background:#238636;color:#fff;border:none;border-radius:10px;cursor:pointer}
  button:hover{background:#2ea043}

  /* Biobot */
  .biobot{
    margin:12px;padding:14px;border-radius:14px;background:rgba(14,26,62,.7);
    border:1px solid var(--line);box-shadow:0 0 14px rgba(74,222,128,.35);display:flex;gap:10px;align-items:center
  }
  .face{width:40px;height:40px;border-radius:50%;display:grid;place-items:center;
        background:radial-gradient(circle,#4ade80,#166534);color:#062315;font-weight:bold}

  /* Resultado */
  #resultado{margin:12px;padding:12px;border-radius:12px;background:var(--glass);border:1px solid var(--line)}
</style>
</head>
<body>
<canvas id="starfield"></canvas>

<header>
  <h1>Pilar 2: Abstracción</h1>
  <div class="sub">Filtra lo esencial de lo irrelevante</div>
</header>

<!-- Biobot -->
<section class="panel">
  <div class="biobot">
    <div class="face">◎</div>
    <div id="biobotMsg">Cargando…</div>
  </div>
</section>

<!-- Bandeja -->
<div id="toolbox" class="tray">
  <!-- Crítico -->
  <div class="chip" draggable="true" data-type="critico">⚡ Nivel de energía</div>
  <div class="chip" draggable="true" data-type="critico">🫁 Presión de oxígeno</div>
  <div class="chip" draggable="true" data-type="critico">🚀 Velocidad de propulsores</div>
  <div class="chip" draggable="true" data-type="critico">🛰️ Estado de antenas</div>
  <div class="chip" draggable="true" data-type="critico">🛡️ Integridad estructural</div>
  <div class="chip" draggable="true" data-type="critico">🧭 Coordenadas de navegación</div>

  <!-- Importante -->
  <div class="chip" draggable="true" data-type="importante">🌡️ Temperatura de cabina</div>
  <div class="chip" draggable="true" data-type="importante">📐 Calibración de sensores</div>
  <div class="chip" draggable="true" data-type="importante">⏱ Sincronización de reloj atómico</div>
  <div class="chip" draggable="true" data-type="importante">⤴ Trayectoria de reserva</div>
  <div class="chip" draggable="true" data-type="importante">⛽ Margen de combustible</div>

  <!-- Irrelevante -->
  <div class="chip" draggable="true" data-type="ruido">🎶 Playlist de karaoke</div>
  <div class="chip" draggable="true" data-type="ruido">📸 Selfies de la tripulación</div>
  <div class="chip" draggable="true" data-type="ruido">🎨 Color del casco</div>
  <div class="chip" draggable="true" data-type="ruido">🕹️ Ranking de videojuegos</div>
  <div class="chip" draggable="true" data-type="ruido">🍽 Menú del día</div>
  <div class="chip" draggable="true" data-type="ruido">✦ Horóscopo estelar</div>
  <div class="chip" draggable="true" data-type="ruido">🗞 Chismes de hangar</div>
  <div class="chip" draggable="true" data-type="ruido">🎯 Puntuación en dardos</div>
  <div class="chip" draggable="true" data-type="ruido">🌱 Jardinería de a bordo</div>
</div>

<!-- Zonas -->
<div class="zones">
  <div class="zone" data-accept="critico"><h3>CRÍTICO</h3><div class="bucket" id="bucket-critico"></div></div>
  <div class="zone" data-accept="importante"><h3>IMPORTANTE</h3><div class="bucket" id="bucket-importante"></div></div>
  <div class="zone" data-accept="ruido"><h3>IRRELEVANTE</h3><div class="bucket" id="bucket-ruido"></div></div>
</div>

<!-- Acciones -->
<div class="actions">
  <button id="shuffleBtn">Barajar señales</button>
  <button id="resetBtn">Reiniciar</button>
  <button id="evalBtn">Evaluar modelo</button>
</div>

<div id="resultado"></div>

<script>
/* Fondo estelar */
(function(){
  const c=document.getElementById('starfield'),ctx=c.getContext('2d');
  function resize(){c.width=innerWidth;c.height=innerHeight}resize();
  addEventListener('resize',resize);
  const stars=[...Array(140)].map(()=>({x:Math.random()*c.width,y:Math.random()*c.height,z:Math.random()*1.3+.2,r:Math.random()*1.4+.2}));
  function step(){
    ctx.clearRect(0,0,c.width,c.height);
    for(const s of stars){
      s.x+=s.z*0.22; s.y+=s.z*0.10;
      if(s.x>c.width) s.x=0; if(s.y>c.height) s.y=0;
      ctx.globalAlpha=.35+s.z*.45; ctx.fillStyle='#bcd7ff';
      ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();
    }
    requestAnimationFrame(step);
  } step();
})();

/* Correcto */
const CORRECT={
  critico:["Nivel de energía","Presión de oxígeno","Velocidad de propulsores","Estado de antenas","Integridad estructural","Coordenadas de navegación"],
  importante:["Temperatura de cabina","Calibración de sensores","Sincronización de reloj atómico","Trayectoria de reserva","Margen de combustible"],
  ruido:["Playlist de karaoke","Selfies de la tripulación","Color del casco","Ranking de videojuegos","Menú del día","Horóscopo estelar","Chismes de hangar","Puntuación en dardos","Jardinería de a bordo"]
};
function textOfChip(el){return el.textContent.replace(/^[^ ]* /,"").trim()}

/* Drag */
let dragItem=null;
function bindDrag(){
  document.querySelectorAll('.chip').forEach(c=>{
    c.addEventListener('dragstart',()=>dragItem=c);
    c.addEventListener('dragend',()=>dragItem=null);
  });
  document.querySelectorAll('.zone').forEach(z=>{
    z.addEventListener('dragover',e=>e.preventDefault());
    z.addEventListener('drop',e=>{
      e.preventDefault();
      if(dragItem && z.dataset.accept===dragItem.dataset.type){
        z.querySelector('.bucket').appendChild(dragItem);
      }
    });
  });
}
function shuffleChildren(c){
  const a=[...c.children];
  for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));c.appendChild(a[j]);}
}
document.addEventListener('DOMContentLoaded',()=>{
  const toolbox=document.getElementById('toolbox');
  shuffleChildren(toolbox); bindDrag();
  document.getElementById('shuffleBtn').onclick=()=>{document.querySelectorAll('.bucket .chip').forEach(ch=>toolbox.appendChild(ch));shuffleChildren(toolbox)};
  document.getElementById('resetBtn').onclick=()=>{document.querySelectorAll('.bucket .chip').forEach(ch=>toolbox.appendChild(ch));shuffleChildren(toolbox);document.getElementById('resultado').innerHTML=""};
  document.getElementById('evalBtn').onclick=evaluar;
});

/* Evaluar */
function evaluar(){
  const buckets={
    critico:[...document.querySelectorAll('#bucket-critico .chip')].map(textOfChip),
    importante:[...document.querySelectorAll('#bucket-importante .chip')].map(textOfChip),
    ruido:[...document.querySelectorAll('#bucket-ruido .chip')].map(textOfChip)
  };
  let aciertos=0, errores=0, faltantes=0, total=0;
  for(const tipo in CORRECT){
    total+=CORRECT[tipo].length;
    buckets[tipo].forEach(c=>CORRECT[tipo].includes(c)?aciertos++:errores++);
    CORRECT[tipo].forEach(e=>{if(!buckets[tipo].includes(e)) faltantes++});
  }
  const completos=aciertos;
  const incompletos=faltantes;
  document.getElementById("resultado").innerHTML=
    `<p>Completados: ${completos} ✅ · Incompletos: ${incompletos} ⏳ · Errores: ${errores} ⚠️</p>`;
  biobotSpeak("Misión completada. La abstracción te permitió reducir información compleja a lo esencial. En la vida real la usamos cuando filtramos datos en un informe, resumimos un texto sin perder lo importante o nos enfocamos solo en las variables críticas de un entrenamiento.");
}

/* Biobot con voz */
let selectedVoice=null;
function pickSpanishVoice(){
  const vs=window.speechSynthesis.getVoices();
  selectedVoice = vs.find(v=>/^es(-|_|$)/i.test(v.lang)) || vs[0] || null;
}
if('speechSynthesis' in window){
  window.speechSynthesis.onvoiceschanged = pickSpanishVoice;
  pickSpanishVoice();
}
function biobotSpeak(msg){
  const bio=document.getElementById("biobotMsg");
  bio.innerHTML=msg;
  if('speechSynthesis' in window){
    window.speechSynthesis.cancel();
    const u=new SpeechSynthesisUtterance(msg.replace(/<[^>]+>/g,''));
    if(selectedVoice) u.voice=selectedVoice;
    u.lang= selectedVoice?.lang || "es-ES"; u.rate=1;
    setTimeout(()=>window.speechSynthesis.speak(u),300);
  }
}
/* Mensaje inicial */
biobotSpeak("Soy Biobot. En el Pilar 2 trabajaremos la Abstracción: enfocarse en lo esencial e ignorar lo irrelevante. Tu misión es clasificar 20 señales en Crítico, Importante o Irrelevante para simplificar el modelo de vuelo.");
</script>
</body>
</html>
