<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tesauros en Investigaci√≥n Deportiva | Presentaci√≥n</title>

  <!-- Tema visual (del 1er c√≥digo): Libre Baskerville + Inter -->
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:wght@400;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body{
      font-family:'Inter', sans-serif;
      background:#0a0e27;
      color:#2c3e50;
      overflow:hidden;
      height:100vh;
    }

    .presentation-wrapper{
      height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:40px;
    }

    .slide{
      background:#fff;
      width:100%;
      max-width:1400px;
      height:85vh;
      border-radius:0;
      box-shadow:0 20px 60px rgba(0,0,0,0.5);
      display:none;
      flex-direction:column;
      position:relative;
    }

    .slide.active{ display:flex; animation:fadeIn .45s ease; }
    @keyframes fadeIn{ from{opacity:0; transform:scale(.985);} to{opacity:1; transform:scale(1);} }

    .slide-header{
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      padding:34px 56px;
      color:#fff;
      border-bottom:4px solid #e74c3c;
    }
    .slide-number{
      font-size:13px;
      font-weight:300;
      letter-spacing:2px;
      opacity:.85;
      margin-bottom:8px;
      text-transform:uppercase;
    }
    .slide-title{
      font-family:'Libre Baskerville', serif;
      font-size:40px;
      font-weight:700;
      line-height:1.2;
    }

    .slide-content{
      flex:1;
      padding:40px 56px;
      overflow-y:auto;
    }
    .slide-content::-webkit-scrollbar{ width:8px; }
    .slide-content::-webkit-scrollbar-track{ background:#f1f1f1; }
    .slide-content::-webkit-scrollbar-thumb{ background:#bdc3c7; border-radius:4px; }

    .slide-footer{
      padding:18px 56px;
      border-top:1px solid #ecf0f1;
      display:flex;
      justify-content:space-between;
      align-items:center;
      background:#fafafa;
      gap:16px;
    }
    .progress-indicator{
      font-size:13px;
      color:#95a5a6;
      font-weight:600;
      white-space:nowrap;
    }

    /* Botones */
    .btn{
      padding:12px 26px;
      border:none;
      border-radius:4px;
      font-family:'Inter', sans-serif;
      font-size:14px;
      font-weight:700;
      cursor:pointer;
      transition:all .18s ease;
      text-transform:uppercase;
      letter-spacing:.5px;
    }
    .btn-nav{
      background:transparent;
      color:#7f8c8d;
      border:2px solid #bdc3c7;
    }
    .btn-nav:hover{ background:#ecf0f1; border-color:#95a5a6; }
    .btn-primary{
      background:#e74c3c;
      color:#fff;
      border:2px solid #e74c3c;
    }
    .btn-primary:hover{
      background:#c0392b;
      border-color:#c0392b;
      transform:translateY(-2px);
      box-shadow:0 4px 12px rgba(231,76,60,.28);
    }
    .btn-secondary{
      background:transparent;
      color:#3498db;
      border:2px solid #3498db;
    }
    .btn-secondary:hover{ background:#3498db; color:#fff; }
    .btn:disabled{ opacity:.45; cursor:not-allowed; transform:none !important; box-shadow:none !important; }

    /* Tipograf√≠a */
    h2{
      font-family:'Libre Baskerville', serif;
      font-size:30px;
      color:#2c3e50;
      margin-bottom:18px;
      padding-bottom:10px;
      border-bottom:3px solid #e74c3c;
      display:inline-block;
    }
    h3{
      font-family:'Libre Baskerville', serif;
      font-size:20px;
      color:#34495e;
      margin:22px 0 12px;
    }
    p{
      font-size:16.5px;
      line-height:1.7;
      color:#2c3e50;
      margin-bottom:14px;
    }
    code{
      background:#f1f3f4;
      padding:3px 8px;
      border-radius:3px;
      font-family:'Courier New', monospace;
      color:#e74c3c;
      font-size:13px;
    }

    /* Cards */
    .info-card{
      background:#ecf9ff;
      border-left:5px solid #3498db;
      padding:18px 20px;
      margin:18px 0;
    }
    .info-card-title{
      font-weight:800;
      font-size:16.5px;
      color:#2980b9;
      margin-bottom:10px;
    }
    .warning-card{
      background:#fff4e6;
      border-left:5px solid #f39c12;
      padding:18px 20px;
      margin:18px 0;
    }
    .warning-card-title{
      font-weight:800;
      font-size:16.5px;
      color:#e67e22;
      margin-bottom:10px;
    }
    .success-card{
      background:#e8f8f5;
      border-left:5px solid #27ae60;
      padding:18px 20px;
      margin:18px 0;
      display:none;
    }
    .success-card-title{
      font-weight:800;
      font-size:16.5px;
      color:#27ae60;
      margin-bottom:10px;
    }

    /* Listas */
    .content-list{ list-style:none; padding:0; }
    .content-list li{
      padding:8px 0 8px 26px;
      position:relative;
      font-size:16.5px;
      line-height:1.6;
      color:#2c3e50;
    }
    .content-list li::before{
      content:"‚ñ∏";
      position:absolute;
      left:0;
      color:#e74c3c;
      font-size:18px;
      font-weight:800;
    }

    /* Paneles / columnas */
    .two-columns{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:18px;
      margin:16px 0;
      align-items:start;
    }
    .panel{
      background:#f8f9fa;
      border:1px solid #ecf0f1;
      border-radius:4px;
      padding:16px 18px;
    }
    .panel h4{
      font-family:'Libre Baskerville', serif;
      font-size:17px;
      color:#2c3e50;
      margin-bottom:10px;
    }

    /* Preguntas */
    .question-area{
      background:#f8fbff;
      border:2px solid rgba(52,152,219,.22);
      border-radius:4px;
      padding:16px 18px;
      margin-top:14px;
    }
    .question-title{
      font-weight:800;
      font-size:17px;
      color:#2c3e50;
      margin-bottom:12px;
    }

    /* Opci√≥n radio */
    .options-grid{ display:grid; gap:10px; }
    .option-card{
      background:#fff;
      border:2px solid #dfe6e9;
      border-radius:4px;
      padding:14px 14px;
      cursor:pointer;
      transition:all .15s ease;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .option-card:hover{ border-color:#3498db; background:#f8f9fa; }
    .option-card.selected{ border-color:#3498db; background:#ecf9ff; }
    .option-radio{
      width:18px; height:18px;
      border:2px solid #bdc3c7;
      border-radius:50%;
      position:relative;
      flex-shrink:0;
    }
    .option-card.selected .option-radio{ border-color:#3498db; }
    .option-card.selected .option-radio::after{
      content:'';
      position:absolute;
      top:50%; left:50%;
      transform:translate(-50%,-50%);
      width:9px; height:9px;
      background:#3498db;
      border-radius:50%;
    }
    .option-text{ font-size:16.5px; color:#2c3e50; }

    /* Checkbox cards */
    .checkbox-grid{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:10px;
    }
    .checkbox-card{
      background:#fff;
      border:2px solid #dfe6e9;
      border-radius:4px;
      padding:14px 14px;
      cursor:pointer;
      transition:all .15s ease;
      display:flex;
      align-items:center;
      gap:12px;
    }
    .checkbox-card:hover{ border-color:#3498db; background:#f8f9fa; }
    .checkbox-card.selected{ border-color:#3498db; background:#ecf9ff; }
    .option-checkbox{
      width:18px; height:18px;
      border:2px solid #bdc3c7;
      border-radius:4px;
      position:relative;
      flex-shrink:0;
      background:#fff;
    }
    .checkbox-card.selected .option-checkbox{
      border-color:#3498db;
      background:#3498db;
    }
    .checkbox-card.selected .option-checkbox::after{
      content:'';
      position:absolute;
      top:1px; left:5px;
      width:5px; height:10px;
      border:solid #fff;
      border-width:0 2px 2px 0;
      transform:rotate(45deg);
    }

    /* Inputs compactos */
    input[type="text"], textarea, select{
      width:100%;
      padding:10px 10px;
      border:2px solid #dfe6e9;
      border-radius:4px;
      font-family:'Inter', sans-serif;
      font-size:14px;
      transition:border-color .2s;
      background:#fff;
      color:#2c3e50;
      line-height:1.35;
    }
    input[type="text"]:focus, textarea:focus, select:focus{
      outline:none; border-color:#3498db;
    }
    textarea{
      min-height:110px;
      resize:vertical;
      font-family:'Courier New', monospace;
    }

    /* Tabla */
    .data-table{
      width:100%;
      border-collapse:collapse;
      border:1px solid #dfe6e9;
    }
    .data-table th{
      background:#34495e;
      color:#fff;
      padding:12px 12px;
      text-align:left;
      font-weight:800;
      font-size:13.5px;
    }
    .data-table td{
      padding:10px 12px;
      border-bottom:1px solid #ecf0f1;
      vertical-align:middle;
      font-size:14.5px;
      color:#2c3e50;
    }
    .data-table tbody tr:nth-child(even){ background:#f8f9fa; }

    /* Feedback */
    .feedback{
      padding:14px 16px;
      border-radius:4px;
      margin-top:12px;
      display:none;
      font-weight:700;
    }
    .feedback.show{ display:block; }
    .feedback.success{ background:#e8f8f5; border-left:5px solid #27ae60; color:#27ae60; }
    .feedback.error{ background:#fadbd8; border-left:5px solid #e74c3c; color:#c0392b; }
    .feedback.partial{ background:#fff4e6; border-left:5px solid #f39c12; color:#e67e22; }
    .feedback-title{ font-weight:900; margin-bottom:6px; }
    .feedback-text{ font-weight:700; opacity:.95; line-height:1.55; }

    /* Helper */
    .helper{
      font-size:13.5px;
      color:#7f8c8d;
      margin-top:10px;
      display:flex;
      gap:8px;
      align-items:flex-start;
    }
    .helper .icon{ font-size:15px; }

    /* ===== Layout SLIDE Normaliza: sin espacio ‚Äúdesperdiciado‚Äù ===== */
    .slide-content.norm-layout{
      display:grid;
      grid-template-rows:auto 1fr auto; /* top / centro (crece) / bottom */
      gap:14px;
      padding:34px 56px;
      overflow:hidden; /* el scroll pasa al bloque de tabla si hace falta */
    }
    .norm-top{
      display:grid;
      grid-template-columns:1.25fr .75fr;
      gap:14px;
      align-items:start;
    }
    .norm-side{
      background:#f8f9fa;
      border:1px solid #ecf0f1;
      border-radius:4px;
      padding:16px 18px;
    }
    .norm-side h4{
      font-family:'Libre Baskerville', serif;
      font-size:17px;
      margin-bottom:10px;
      color:#2c3e50;
    }
    .norm-side .mini{
      font-size:14.5px;
      line-height:1.55;
      color:#2c3e50;
      margin-bottom:10px;
    }

    .norm-center{
      background:#fff;
      border:1px solid #ecf0f1;
      border-radius:4px;
      padding:14px 14px;
      display:flex;
      flex-direction:column;
      gap:10px;
      min-height:0; /* clave para que crezca bien */
    }
    .controls-row{
      display:flex;
      gap:12px;
      align-items:flex-end;
      flex-wrap:wrap;
    }
    .control{ flex:1 1 420px; min-width:260px; }
    .control label{
      display:block;
      font-weight:800;
      font-size:14px;
      color:#2c3e50;
      margin-bottom:6px;
    }

    .table-grow{
      flex:1;
      min-height:0;
      overflow:auto;
      border-radius:4px;
    }

    .norm-bottom{
      background:#f8f9fa;
      border:1px solid #ecf0f1;
      border-radius:4px;
      padding:14px 16px;
      overflow:hidden;
    }
    .resource-row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .resource-row a{
      text-decoration:none;
      color:#2c3e50;
      background:#fff;
      border:2px solid #dfe6e9;
      padding:10px 12px;
      border-radius:4px;
      font-weight:800;
      font-size:13px;
      transition:all .15s ease;
    }
    .resource-row a:hover{
      border-color:#3498db;
      background:#ecf9ff;
      transform:translateY(-1px);
    }

    /* Caja c√≥digo ecuaci√≥n */
    .code-box{
      background:#f8f9fa;
      border:1px solid #dfe6e9;
      border-left:5px solid #3498db;
      border-radius:4px;
      padding:14px 16px;
      font-family:'Courier New', monospace;
      font-size:14px;
      line-height:1.7;
      white-space:pre-wrap;
    }

    /* Responsive */
    @media (max-width: 1200px){
      .slide-title{ font-size:34px; }
      .two-columns{ grid-template-columns:1fr; }
      .checkbox-grid{ grid-template-columns:1fr; }
      .norm-top{ grid-template-columns:1fr; }
    }
    @media (max-width: 768px){
      .presentation-wrapper{ padding:0; }
      .slide{ height:100vh; }
      .slide-header,.slide-footer{ padding:26px; }
      .slide-content{ padding:26px; }
      .slide-content.norm-layout{ padding:26px; }
      .slide-title{ font-size:26px; }
    }
  </style>
</head>

<body>
  <div class="presentation-wrapper">

    <!-- SLIDE 1 / 7 -->
    <section class="slide active">
      <header class="slide-header">
        <div class="slide-number">INTRODUCCI√ìN</div>
        <h1 class="slide-title">Tesauros en Investigaci√≥n Deportiva</h1>
      </header>

      <div class="slide-content">
        <div class="info-card">
          <div class="info-card-title">Objetivo</div>
          <p>Aprender a <strong>normalizar t√©rminos</strong> con tesauros para construir una <strong>ecuaci√≥n booleana</strong> y buscar evidencia con m√°s precisi√≥n.</p>
        </div>

        <h2>Idea central</h2>
        <ul class="content-list">
          <li>Un tesauro asigna a cada concepto un <strong>nombre oficial</strong>.</li>
          <li>Ese nombre oficial se llama <strong>Descriptor</strong> (en MeSH: <code>MeSH Heading</code>).</li>
          <li>Buscar con descriptores reduce p√©rdidas por sin√≥nimos y variaciones.</li>
        </ul>

        <div class="warning-card">
          <div class="warning-card-title">Caso pr√°ctico</div>
          <p><strong>Tema:</strong> lesiones del tend√≥n de Aquiles en atletas de carrera de larga distancia.</p>
        </div>
      </div>

      <footer class="slide-footer">
        <div class="progress-indicator">1 de 7</div>
        <button class="btn btn-primary" onclick="nextSlide()">COMENZAR ‚Üí</button>
      </footer>
    </section>

    <!-- SLIDE 2 / 7 -->
    <section class="slide">
      <header class="slide-header">
        <div class="slide-number">PASO 1</div>
        <h1 class="slide-title">Concepto principal</h1>
      </header>

      <div class="slide-content">
        <h2>Elegir bien el inicio</h2>

        <div class="two-columns">
          <div class="panel">
            <h4>Regla</h4>
            <ul class="content-list">
              <li>Empieza por el concepto anat√≥mico/patol√≥gico <strong>espec√≠fico</strong>.</li>
              <li>Evita t√©rminos gen√©ricos (dan ruido).</li>
            </ul>
          </div>
          <div class="panel">
            <h4>Tu tema trae</h4>
            <p style="margin:0;">‚Äúlesiones‚Äù, ‚Äútend√≥n de Aquiles‚Äù, ‚Äúatletas‚Äù, ‚Äúcarrera de larga distancia‚Äù.</p>
          </div>
        </div>

        <div class="question-area">
          <div class="question-title">¬øCu√°l es el mejor concepto para buscar primero en el tesauro?</div>
          <div class="options-grid">
            <div class="option-card" onclick="selectOption(this, 'lesiones')">
              <div class="option-radio"></div><div class="option-text">Lesiones</div>
            </div>
            <div class="option-card" onclick="selectOption(this, 'tendon')">
              <div class="option-radio"></div><div class="option-text">Tend√≥n de Aquiles</div>
            </div>
            <div class="option-card" onclick="selectOption(this, 'atletas')">
              <div class="option-radio"></div><div class="option-text">Atletas</div>
            </div>
            <div class="option-card" onclick="selectOption(this, 'carrera')">
              <div class="option-radio"></div><div class="option-text">Carrera de larga distancia</div>
            </div>
          </div>

          <div id="feedback2" class="feedback"></div>
        </div>
      </div>

      <footer class="slide-footer">
        <button class="btn btn-nav" onclick="prevSlide()">‚Üê ANTERIOR</button>
        <div class="progress-indicator">2 de 7</div>
        <button class="btn btn-primary" onclick="checkStep2()">VERIFICAR ‚Üí</button>
      </footer>
    </section>

    <!-- SLIDE 3 / 7 -->
    <section class="slide">
      <header class="slide-header">
        <div class="slide-number">CONCEPTO CLAVE</div>
        <h1 class="slide-title">¬øQu√© es un descriptor?</h1>
      </header>

      <div class="slide-content">
        <h2>Definici√≥n operativa</h2>

        <div class="info-card">
          <div class="info-card-title">Descriptor</div>
          <p>Es el <strong>nombre oficial</strong> del concepto en el tesauro (lenguaje controlado). Es el t√©rmino que debes usar al buscar en bases de datos.</p>
        </div>

        <div class="warning-card">
          <div class="warning-card-title">Descriptor preferido</div>
          <p>Si buscas ‚ÄúTend√≥n de Aquiles‚Äù en DeCS, el tesauro puede mostrar un <strong>descriptor preferido distinto</strong>, por ejemplo: <strong>‚ÄúTend√≥n Calc√°neo‚Äù</strong>. Ese es el t√©rmino correcto para buscar.</p>
        </div>

        <h3>Qu√© har√°s despu√©s</h3>
        <ul class="content-list">
          <li>Elegir el tesauro (MeSH/DeCS/etc.).</li>
          <li>Traducir al ingl√©s <strong>solo si usas MeSH</strong>.</li>
          <li>Copiar el descriptor oficial (MeSH Heading / Descriptor).</li>
        </ul>
      </div>

      <footer class="slide-footer">
        <button class="btn btn-nav" onclick="prevSlide()">‚Üê ANTERIOR</button>
        <div class="progress-indicator">3 de 7</div>
        <button class="btn btn-primary" onclick="nextSlide()">NORMALIZAR ‚Üí</button>
      </footer>
    </section>

    <!-- SLIDE 4 / 7 (NORMALIZA SIN ESPACIO DESPERDICIADO) -->
    <section class="slide">
      <header class="slide-header">
        <div class="slide-number">PASO 2</div>
        <h1 class="slide-title">Normaliza en tesauros</h1>
      </header>

      <div class="slide-content norm-layout">
        <!-- TOP -->
        <div class="norm-top">
          <div class="info-card" style="margin:0;">
            <div class="info-card-title">C√≥mo hacerlo (flujo real)</div>
            <ul class="content-list">
              <li><strong>Elige tesauro</strong> (MeSH recomendado en biomedicina / DeCS en espa√±ol).</li>
              <li><strong>Si es MeSH:</strong> traduce tu palabra clave al ingl√©s.</li>
              <li>Busca el t√©rmino en el tesauro.</li>
              <li>Copia el <strong>Descriptor oficial</strong> (en MeSH: <code>MeSH Heading</code>).</li>
              <li>(Opcional) Revisa <em>Entry Terms</em> para sin√≥nimos.</li>
            </ul>
          </div>

          <aside class="norm-side">
            <h4>Qu√© significa en la pr√°ctica</h4>
            <div class="mini">
              <strong>Descriptor</strong> = etiqueta oficial del concepto.
              Si el tesauro ‚Äúcambia‚Äù el t√©rmino, te est√° dando el nombre correcto.
            </div>
            <div class="mini">
              Ejemplo: buscar <strong>‚ÄúTend√≥n de Aquiles‚Äù</strong> en DeCS puede devolver <strong>‚ÄúTend√≥n Calc√°neo‚Äù</strong> como descriptor preferido.
            </div>
            <div class="warning-card" style="margin:0; padding:12px 14px;">
              <div class="warning-card-title" style="margin-bottom:6px;">Regla</div>
              <p style="margin:0; font-size:14.5px; line-height:1.55;">
                Copia el descriptor tal cual aparece (ortograf√≠a, may√∫sculas/espacios).
              </p>
            </div>
          </aside>
        </div>

        <!-- CENTER -->
        <div class="norm-center">
          <div class="controls-row">
            <div class="control">
              <label for="thesaurus">Elige tesauro</label>
              <select id="thesaurus" onchange="onThesaurusChange()">
                <option value="">Selecciona...</option>
                <option value="mesh">MeSH ‚Äî Salud/Biomedicina (recomendado)</option>
                <option value="decs">DeCS ‚Äî Salud (LatAm)</option>
                <option value="eric">ERIC ‚Äî Educaci√≥n</option>
                <option value="unesco">UNESCO ‚Äî Cs. Sociales</option>
              </select>
            </div>

            <div style="display:flex; gap:10px; flex-wrap:wrap;">
              <button class="btn btn-secondary" onclick="openTranslator()">ABRIR TRADUCTOR</button>
              <button class="btn btn-primary" id="open-thesaurus-btn" onclick="openThesaurus()" disabled>ABRIR TESAURO ‚Üí</button>
            </div>
          </div>

          <div class="table-grow">
            <table class="data-table" aria-label="Tabla de normalizaci√≥n">
              <thead>
                <tr>
                  <th style="width:26%;">Palabra clave (ES)</th>
                  <th style="width:32%;">Traducci√≥n (si usas MeSH)</th>
                  <th style="width:42%;" id="descriptorHeader">Descriptor oficial</th>
                </tr>
              </thead>
              <tbody id="norm-body"></tbody>
            </table>

            <div class="helper">
              <span class="icon">üîé</span>
              <div>
                <div><strong>MeSH:</strong> copia el <code>MeSH Heading</code> en <em>Details</em>.</div>
                <div style="margin-top:4px;"><strong>DeCS:</strong> copia <strong>Descriptor</strong> (t√©rmino preferido).</div>
              </div>
            </div>

            <div id="norm-feedback" class="feedback error">
              <div class="feedback-title">Falta completar</div>
              <div class="feedback-text">Completa al menos <strong>2 descriptores oficiales</strong> para continuar.</div>
            </div>
          </div>
        </div>

        <!-- BOTTOM -->
        <div class="norm-bottom">
          <h3 style="margin:0 0 8px;">¬øPara qu√© usar la ecuaci√≥n booleana resultante?</h3>
          <ul class="content-list" style="margin:0;">
            <li><strong>Mejor cobertura</strong>: no pierdes art√≠culos por sin√≥nimos o variantes.</li>
            <li><strong>M√°s precisi√≥n</strong>: <code>AND</code> reduce ruido, <code>OR</code> ampl√≠a recuperaci√≥n.</li>
            <li><strong>Reproducible</strong>: puedes reportar la ecuaci√≥n en tu trabajo y repetir la b√∫squeda.</li>
          </ul>
          <div class="resource-row">
            <a href="https://pubmed.ncbi.nlm.nih.gov/" target="_blank" rel="noopener noreferrer">PubMed</a>
            <a href="https://www.scopus.com/" target="_blank" rel="noopener noreferrer">Scopus</a>
            <a href="https://www.webofscience.com/" target="_blank" rel="noopener noreferrer">Web of Science</a>
            <a href="https://scholar.google.com/" target="_blank" rel="noopener noreferrer">Google Scholar</a>
            <a href="https://lilacs.bvsalud.org/" target="_blank" rel="noopener noreferrer">LILACS</a>
          </div>
        </div>
      </div>

      <footer class="slide-footer">
        <button class="btn btn-nav" onclick="prevSlide()">‚Üê ANTERIOR</button>
        <div class="progress-indicator">4 de 7</div>
        <button class="btn btn-primary" onclick="validateNormalization()">SIGUIENTE ‚Üí</button>
      </footer>
    </section>

    <!-- SLIDE 5 / 7 -->
    <section class="slide">
      <header class="slide-header">
        <div class="slide-number">PASO 3</div>
        <h1 class="slide-title">T√©rminos relacionados</h1>
      </header>

      <div class="slide-content">
        <h2>Ampl√≠a sin perder foco</h2>
        <p>Adem√°s del descriptor del tend√≥n, conviene agregar t√©rminos de lesi√≥n y de poblaci√≥n/contexto para filtrar la evidencia.</p>

        <div class="question-area">
          <div class="question-title">Selecciona t√©rminos √∫tiles para lesiones en corredores:</div>
          <div class="checkbox-grid">
            <div class="checkbox-card" onclick="toggleCheckbox(this, 'ruptura')">
              <div class="option-checkbox"></div><div class="option-text">Ruptura</div>
            </div>
            <div class="checkbox-card" onclick="toggleCheckbox(this, 'tendinopatia')">
              <div class="option-checkbox"></div><div class="option-text">Tendinopat√≠a</div>
            </div>
            <div class="checkbox-card" onclick="toggleCheckbox(this, 'carrera')">
              <div class="option-checkbox"></div><div class="option-text">Carrera</div>
            </div>
            <div class="checkbox-card" onclick="toggleCheckbox(this, 'atletas')">
              <div class="option-checkbox"></div><div class="option-text">Atletas</div>
            </div>
          </div>

          <div id="feedback5" class="feedback"></div>
        </div>
      </div>

      <footer class="slide-footer">
        <button class="btn btn-nav" onclick="prevSlide()">‚Üê ANTERIOR</button>
        <div class="progress-indicator">5 de 7</div>
        <button class="btn btn-primary" onclick="checkRelated()">VERIFICAR ‚Üí</button>
      </footer>
    </section>

    <!-- SLIDE 6 / 7 -->
    <section class="slide">
      <header class="slide-header">
        <div class="slide-number">PASO 4</div>
        <h1 class="slide-title">Construye la ecuaci√≥n</h1>
      </header>

      <div class="slide-content">
        <h2>Operadores booleanos</h2>

        <div class="two-columns">
          <div class="panel">
            <h4>C√≥mo se usa</h4>
            <ul class="content-list">
              <li><code>OR</code> para sin√≥nimos/variantes (mismo concepto).</li>
              <li><code>AND</code> para conceptos diferentes (filtro).</li>
              <li>Par√©ntesis para agrupar.</li>
            </ul>
          </div>
          <div class="panel">
            <h4>Plantilla</h4>
            <p style="margin:0;">
              <code>("Descriptor 1" OR "Sin√≥nimo") AND ("Descriptor 2") AND ("Contexto")</code>
            </p>
          </div>
        </div>

        <div class="question-area">
          <div class="question-title">Generaremos una ecuaci√≥n base con tus descriptores:</div>
          <div class="code-box" id="equationPreview">(Completa la normalizaci√≥n en el paso anterior)</div>

          <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
            <button class="btn btn-secondary" onclick="copyEquation()">COPIAR ECUACI√ìN</button>
            <button class="btn btn-primary" onclick="nextSlide()">CONTINUAR ‚Üí</button>
          </div>

          <div id="feedback6" class="feedback"></div>
        </div>
      </div>

      <footer class="slide-footer">
        <button class="btn btn-nav" onclick="prevSlide()">‚Üê ANTERIOR</button>
        <div class="progress-indicator">6 de 7</div>
        <button class="btn btn-primary" onclick="nextSlide()">FINAL ‚Üí</button>
      </footer>
    </section>

    <!-- SLIDE 7 / 7 -->
    <section class="slide">
      <header class="slide-header">
        <div class="slide-number">CIERRE</div>
        <h1 class="slide-title">C√≥mo usar tu ecuaci√≥n</h1>
      </header>

      <div class="slide-content">
        <h2>Tu ecuaci√≥n final</h2>
        <div class="code-box" id="equationFinal">(A√∫n no generada)</div>

        <div class="info-card">
          <div class="info-card-title">¬øPara qu√© sirve exactamente?</div>
          <ul class="content-list">
            <li><strong>Buscar mejor evidencia</strong> (menos ruido, m√°s cobertura).</li>
            <li><strong>Documentar metodolog√≠a</strong> (lo puedes escribir en tu informe/tesis).</li>
            <li><strong>Repetir b√∫squedas</strong> en distintas bases de datos con la misma l√≥gica.</li>
          </ul>
        </div>

        <h3>D√≥nde pegarla</h3>
        <div class="resource-row">
          <a href="https://pubmed.ncbi.nlm.nih.gov/" target="_blank" rel="noopener noreferrer">PubMed</a>
          <a href="https://www.scopus.com/" target="_blank" rel="noopener noreferrer">Scopus</a>
          <a href="https://www.webofscience.com/" target="_blank" rel="noopener noreferrer">Web of Science</a>
          <a href="https://scholar.google.com/" target="_blank" rel="noopener noreferrer">Google Scholar</a>
          <a href="https://lilacs.bvsalud.org/" target="_blank" rel="noopener noreferrer">LILACS</a>
        </div>

        <div class="success-card" id="final-card">
          <div class="success-card-title">Listo</div>
          <p style="margin:0;">Ya tienes una ecuaci√≥n reproducible basada en descriptores oficiales.</p>
        </div>
      </div>

      <footer class="slide-footer">
        <button class="btn btn-nav" onclick="prevSlide()">‚Üê ANTERIOR</button>
        <div class="progress-indicator">7 de 7</div>
        <button class="btn btn-primary" onclick="resetAll()">REINICIAR ‚Ü∫</button>
      </footer>
    </section>

  </div>

  <script>
    // ===== Navegaci√≥n slides =====
    let currentSlide = 0;
    function showSlide(index){
      const slides = document.querySelectorAll('.slide');
      slides.forEach((s,i)=>s.classList.toggle('active', i===index));
      currentSlide = index;

      // actualiza previews si entra a slides 6/7
      if (index === 5 || index === 6) refreshEquationViews();
    }
    function nextSlide(){
      const slides = document.querySelectorAll('.slide');
      if (currentSlide < slides.length - 1) showSlide(currentSlide + 1);
    }
    function prevSlide(){
      if (currentSlide > 0) showSlide(currentSlide - 1);
    }

    // ===== Slide 2 (concepto principal) =====
    let selectedOption = null;
    function selectOption(el, value){
      document.querySelectorAll('.option-card').forEach(c=>c.classList.remove('selected'));
      el.classList.add('selected');
      selectedOption = value;
      clearFeedback('feedback2');
    }
    function showFeedback(id, type, title, message){
      const fb = document.getElementById(id);
      fb.className = `feedback ${type} show`;
      fb.innerHTML = `<div class="feedback-title">${title}</div><div class="feedback-text">${message}</div>`;
    }
    function clearFeedback(id){
      const fb = document.getElementById(id);
      if (!fb) return;
      fb.className = 'feedback';
      fb.innerHTML = '';
    }
    function checkStep2(){
      if (!selectedOption){
        showFeedback('feedback2','error','Selecciona una opci√≥n','Elige el concepto m√°s apropiado para iniciar en el tesauro.');
        return;
      }
      if (selectedOption==='tendon'){
        showFeedback('feedback2','success','Correcto','‚ÄúTend√≥n de Aquiles‚Äù es espec√≠fico y funciona muy bien para iniciar.');
        setTimeout(()=>nextSlide(), 800);
      } else if (selectedOption==='lesiones'){
        showFeedback('feedback2','error','Demasiado general','‚ÄúLesiones‚Äù es muy amplio. Primero fija la estructura anat√≥mica espec√≠fica.');
      } else if (selectedOption==='atletas'){
        showFeedback('feedback2','error','Es contexto/poblaci√≥n','‚ÄúAtletas‚Äù no es el concepto anat√≥mico/patol√≥gico central para iniciar en tesauro.');
      } else if (selectedOption==='carrera'){
        showFeedback('feedback2','error','Es contexto','‚ÄúCarrera‚Ä¶‚Äù es contexto. Primero define el concepto anat√≥mico/patol√≥gico.');
      }
    }

    // ===== Slide 4 (normalizaci√≥n) =====
    const defaultKeywords = [
      { es: 'tend√≥n de Aquiles', en: '' },
      { es: 'tendinopat√≠a', en: '' },
      { es: 'ruptura', en: '' }
    ];
    let normKeywords = [...defaultKeywords];
    let savedDescriptors = []; // se llena al validar normalizaci√≥n

    function renderNormTable(){
      const tbody = document.getElementById('norm-body');
      tbody.innerHTML = '';

      normKeywords.forEach((row, idx)=>{
        const tr = document.createElement('tr');

        const tdEs = document.createElement('td');
        tdEs.textContent = row.es;
        tdEs.style.fontWeight = '900';

        const tdEn = document.createElement('td');
        const inEn = document.createElement('input');
        inEn.type = 'text';
        inEn.placeholder = 'Traducci√≥n (solo si usas MeSH)';
        inEn.value = row.en || '';
        inEn.addEventListener('input', (e)=>{ normKeywords[idx].en = e.target.value; });
        tdEn.appendChild(inEn);

        const tdDesc = document.createElement('td');
        const inDesc = document.createElement('input');
        inDesc.type = 'text';
        inDesc.placeholder = 'Copia aqu√≠ el descriptor oficial';
        inDesc.className = 'desc-input';
        tdDesc.appendChild(inDesc);

        tr.appendChild(tdEs);
        tr.appendChild(tdEn);
        tr.appendChild(tdDesc);
        tbody.appendChild(tr);
      });
    }

    function onThesaurusChange(){
      const v = document.getElementById('thesaurus').value;
      const btn = document.getElementById('open-thesaurus-btn');
      btn.disabled = !v;

      const header = document.getElementById('descriptorHeader');
      header.textContent = (v === 'mesh')
        ? 'Descriptor oficial (MeSH Heading)'
        : 'Descriptor oficial (del tesauro)';

      clearFeedback('norm-feedback');
    }

    function openTranslator(){
      window.open('https://translate.google.com/?sl=es&tl=en', '_blank', 'noopener,noreferrer');
    }

    function openThesaurus(){
      const v = document.getElementById('thesaurus').value;
      const urls = {
        mesh: 'https://meshb.nlm.nih.gov/',
        decs: 'https://decs.bvsalud.org/',
        eric: 'https://eric.ed.gov/',
        unesco: 'https://vocabularies.unesco.org/'
      };
      if (!v || !urls[v]) return;
      window.open(urls[v], '_blank', 'noopener,noreferrer');
    }

    function validateNormalization(){
      const descInputs = document.querySelectorAll('.desc-input');
      const filled = Array.from(descInputs).map(i=>i.value.trim()).filter(Boolean);

      if (filled.length < 2){
        const fb = document.getElementById('norm-feedback');
        fb.className = 'feedback error show';
        fb.innerHTML = `<div class="feedback-title">Falta completar</div>
                        <div class="feedback-text">Completa al menos <strong>2 descriptores oficiales</strong> para continuar.</div>`;
        return;
      }

      savedDescriptors = filled.slice(0); // guarda todos
      clearFeedback('norm-feedback');
      nextSlide();
    }

    // ===== Slide 5 (t√©rminos relacionados) =====
    let selectedTerms = new Set();
    function toggleCheckbox(el, value){
      el.classList.toggle('selected');
      if (el.classList.contains('selected')) selectedTerms.add(value);
      else selectedTerms.delete(value);
      clearFeedback('feedback5');
    }

    function checkRelated(){
      if (selectedTerms.size === 0){
        showFeedback('feedback5','error','Selecciona al menos uno','Marca t√©rminos relevantes para ampliar tu b√∫squeda.');
        return;
      }

      const hasLesion = selectedTerms.has('ruptura') || selectedTerms.has('tendinopatia');
      const hasContext = selectedTerms.has('carrera') || selectedTerms.has('atletas');

      if (selectedTerms.size === 4){
        showFeedback('feedback5','success','Selecci√≥n completa','Incluiste lesi√≥n + contexto. Perfecto.');
        setTimeout(()=>nextSlide(), 850);
      } else if (hasLesion && hasContext){
        showFeedback('feedback5','partial','Selecci√≥n v√°lida','Est√° bien. Para m√°xima cobertura, incluye los 4.');
        setTimeout(()=>nextSlide(), 1100);
      } else if (hasLesion && !hasContext){
        showFeedback('feedback5','error','Falta contexto','A√±ade ‚ÄúCarrera‚Äù o ‚ÄúAtletas‚Äù para enfocar la poblaci√≥n.');
      } else {
        showFeedback('feedback5','error','Faltan t√©rminos de lesi√≥n','A√±ade ‚ÄúRuptura‚Äù y/o ‚ÄúTendinopat√≠a‚Äù para precisar el da√±o.');
      }
    }

    // ===== Ecuaci√≥n booleana (base) =====
    function buildEquation(){
      if (!savedDescriptors || savedDescriptors.length === 0) return '';
      // Base: cada descriptor entre comillas y unido con AND
      const quoted = savedDescriptors.map(d => `"${d}"`);
      return quoted.join(' AND ');
    }

    function refreshEquationViews(){
      const eq = buildEquation();
      const preview = document.getElementById('equationPreview');
      const final = document.getElementById('equationFinal');

      if (preview) preview.textContent = eq ? eq : '(Completa la normalizaci√≥n en el paso 2)';
      if (final) final.textContent = eq ? eq : '(A√∫n no generada)';

      const card = document.getElementById('final-card');
      if (card) card.style.display = eq ? 'block' : 'none';
    }

    function copyEquation(){
      const eq = buildEquation();
      if (!eq){
        showFeedback('feedback6','error','No hay ecuaci√≥n','Primero completa al menos 2 descriptores en ‚ÄúNormaliza en tesauros‚Äù.');
        return;
      }

      // Copia al portapapeles
      navigator.clipboard?.writeText(eq).then(()=>{
        showFeedback('feedback6','success','Copiado','Ecuaci√≥n copiada al portapapeles.');
      }).catch(()=>{
        // fallback
        const tmp = document.createElement('textarea');
        tmp.value = eq;
        document.body.appendChild(tmp);
        tmp.select();
        document.execCommand('copy');
        document.body.removeChild(tmp);
        showFeedback('feedback6','success','Copiado','Ecuaci√≥n copiada al portapapeles.');
      });
    }

    // ===== Reset =====
    function resetAll(){
      selectedOption = null;
      selectedTerms.clear();
      savedDescriptors = [];
      normKeywords = [...defaultKeywords];

      document.querySelectorAll('.option-card, .checkbox-card').forEach(c=>c.classList.remove('selected'));
      document.querySelectorAll('.feedback').forEach(f=>{ f.className='feedback'; f.innerHTML=''; });

      const th = document.getElementById('thesaurus');
      if (th) th.value = '';
      const btn = document.getElementById('open-thesaurus-btn');
      if (btn) btn.disabled = true;

      renderNormTable();
      refreshEquationViews();
      showSlide(0);
    }

    // init
    renderNormTable();
    showSlide(0);
  </script>
</body>
</html>

